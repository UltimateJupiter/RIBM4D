/***************************************************************************
  **************************************************************************
    
  Spherical Harmonic Transform Kit 2.7
    
  Copyright 1997-2003  Sean Moore, Dennis Healy,
                       Dan Rockmore, Peter Kostelec
  Copyright 2004  Peter Kostelec, Dan Rockmore

  This file is part of SpharmonicKit.

  SpharmonicKit is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 3 of the License, or
  (at your option) any later version.

  SpharmonicKit is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  
  See the accompanying LICENSE file for details.

  ************************************************************************
  ************************************************************************/

/* quadrature weights file */


/**
  contains precomputed arrays of Legendre quadrature weight values
  for ODD order !!! The sin factor is already present here !!!
  In a nutshell, the purpose of precomputing these weights is to
  save a multiplication in seminaivex.c (when the order is odd).
  **/

/***

  The interface function to these arrays is defined at the end
  of this file. It is

  const double *get_oddweights( int bw )

  ***/

__device__ double ow4[8] =
{0.0130677244459852, 0.1238854579060207, 0.2695229693546575, 0.3784620915132186, 
 0.3784620915135136, 0.2695229693547305, 0.1238854579060396, 0.0130677244459872};

__device__ double ow8[16] =
{0.0016469580173477, 0.0169341816445308, 0.0432357135521227, 0.0793813894095676, 
 0.1170279554057073, 0.1529422668923013, 0.1796652878558445, 0.1945100966313875, 
 0.1945100966320044, 0.1796652878560336, 0.1529422668923990, 0.1170279554057610, 
 0.0793813894095944, 0.0432357135521349, 0.0169341816445349, 0.0016469580173482};

__device__ double ow16[32] =
{0.0002062930740058, 0.0021640291839523, 0.0057415678114794, 0.0111972504895041, 
 0.0178930728089408, 0.0259990600279925, 0.0347897736331906, 0.0443206791778128, 
 0.0538581883411703, 0.0633727713806255, 0.0721958552759619, 0.0802540295805748, 
 0.0870119991694323, 0.0923933475135159, 0.0960521727207131, 0.0979413816063274, 
 0.0979413816075809, 0.0960521727211216, 0.0923933475137517, 0.0870119991695906, 
 0.0802540295806897, 0.0721958552760469, 0.0633727713806883, 0.0538581883412164, 
 0.0443206791778439, 0.0347897736332128, 0.0259990600280075, 0.0178930728089499, 
 0.0111972504895093, 0.0057415678114816, 0.0021640291839533, 0.0002062930740059};

__device__ double ow32[64] =
{0.0000257998762313, 0.0002719963328992, 0.0007285551655023, 0.0014419143849654, 
 0.0023492196299524, 0.0034990775392484, 0.0048228709609411, 0.0063650580023922, 
 0.0080542400902157, 0.0099298000591963, 0.0119191123704765, 0.0140563265952599, 
 0.0162689596309466, 0.0185860547971697, 0.0209366261496682, 0.0233449007140944, 
 0.0257427470523766, 0.0281499721421785, 0.0305026394644358, 0.0328165981698009, 
 0.0350333990269573, 0.0371654265132021, 0.0391609283963208, 0.0410293162611077, 
 0.0427266274173210, 0.0442597612670725, 0.0455934877956728, 0.0467325973884478, 
 0.0476513580258637, 0.0483527742646833, 0.0488211762339878, 0.0490580082650788, 
 0.0490580082676000, 0.0488211762348225, 0.0483527742651796, 0.0476513580262125, 
 0.0467325973887132, 0.0455934877958839, 0.0442597612672463, 0.0427266274174657, 
 0.0410293162612303, 0.0391609283964271, 0.0371654265132945, 0.0350333990270351, 
 0.0328165981698689, 0.0305026394644934, 0.0281499721422278, 0.0257427470524194, 
 0.0233449007141283, 0.0209366261496963, 0.0185860547971938, 0.0162689596309663, 
 0.0140563265952755, 0.0119191123704894, 0.0099298000592062, 0.0080542400902239, 
 0.0063650580023980, 0.0048228709609452, 0.0034990775392512, 0.0023492196299544, 
 0.0014419143849666, 0.0007285551655031, 0.0002719963328996, 0.0000257998762314};

__device__ double ow64[128] =
{0.0000032253984437, 0.0000340463131158, 0.0000914113258540, 0.0001815794657534, 
 0.0002972579769116, 0.0004454616309845, 0.0006184538564501, 0.0008232297879527, 
 0.0010518793946314, 0.0013112566599011, 0.0015933553489263, 0.0019048449349610, 
 0.0022376655422937, 0.0025982788787924, 0.0029786044203960, 0.0033848806292108, 
 0.0038090361826578, 0.0042570748486767, 0.0047209633097769, 0.0052064617945353, 
 0.0057056035126863, 0.0062238982588875, 0.0067534742806377, 0.0072995856431080, 
 0.0078544841887785, 0.0084231643337913, 0.0089980300767539, 0.0095838134769448, 
 0.0101730991587936, 0.0107703551919536, 0.0113683750802881, 0.0119713622227730, 
 0.0125723468987302, 0.0131752679901405, 0.0137734199390811, 0.0143704779852115, 
 0.0149600274557836, 0.0155454814319868, 0.0161207420259307, 0.0166889621432480, 
 0.0172443856007590, 0.0177899075024394, 0.0183201371555761, 0.0188377145219606, 
 0.0193376369013747, 0.0198222919565129, 0.0202870860544883, 0.0207341574880596, 
 0.0211593412034746, 0.0215645290465210, 0.0219460023643870, 0.0223054093866584, 
 0.0226394938764397, 0.0229496631067230, 0.0232331373589767, 0.0234910853670587, 
 0.0237212160271207, 0.0239244616468889, 0.0240990297467417, 0.0242456179638030, 
 0.0243629402984804, 0.0244514610722414, 0.0245104064147662, 0.0245400082524635, 
 0.0245400082575181, 0.0245104064164491, 0.0244514610732485, 0.0243629402991958, 
 0.0242456179643576, 0.0240990297471916, 0.0239244616472670, 0.0237212160274452, 
 0.0234910853673425, 0.0232331373592268, 0.0229496631069464, 0.0226394938766414, 
 0.0223054093868395, 0.0219460023645526, 0.0215645290466719, 0.0211593412036139, 
 0.0207341574881874, 0.0202870860546083, 0.0198222919566235, 0.0193376369014777, 
 0.0188377145220570, 0.0183201371556643, 0.0177899075025212, 0.0172443856008336, 
 0.0166889621433190, 0.0161207420259947, 0.0155454814320465, 0.0149600274558390, 
 0.0143704779852628, 0.0137734199391291, 0.0131752679901853, 0.0125723468987703, 
 0.0119713622228087, 0.0113683750803208, 0.0107703551919828, 0.0101730991588207, 
 0.0095838134769692, 0.0089980300767763, 0.0084231643338125, 0.0078544841887972, 
 0.0072995856431249, 0.0067534742806529, 0.0062238982589012, 0.0057056035126984, 
 0.0052064617945460, 0.0047209633097861, 0.0042570748486851, 0.0038090361826649, 
 0.0033848806292171, 0.0029786044204013, 0.0025982788787973, 0.0022376655422979, 
 0.0019048449349640, 0.0015933553489289, 0.0013112566599029, 0.0010518793946331, 
 0.0008232297879540, 0.0006184538564511, 0.0004454616309852, 0.0002972579769120, 
 0.0001815794657536, 0.0000914113258541, 0.0000340463131159, 0.0000032253984437};

/************************************************************************/
/* returns a pointer to the proper quadrature weights for a given
   bandwidth bw and IF THE ORDER IS ODD.  Weights array is of size 2*bw.
   A closed form for the weights can be found in the original Driscoll
   and Healy paper, but need to be normalized */

__device__ double *get_oddweights( int bw )
{

  switch(bw)
    {
    case 4: return ow4;
    case 8: return ow8;
    case 16: return ow16;
    case 32: return ow32;
    default: return 0;
    }
}
