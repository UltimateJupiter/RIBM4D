/***************************************************************************
  **************************************************************************
    
  Spherical Harmonic Transform Kit 2.7
    
  Copyright 1997-2003  Sean Moore, Dennis Healy,
                       Dan Rockmore, Peter Kostelec
  Copyright 2004  Peter Kostelec, Dan Rockmore

  This file is part of SpharmonicKit.

  SpharmonicKit is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 3 of the License, or
  (at your option) any later version.

  SpharmonicKit is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  
  See the accompanying LICENSE file for details.

  ************************************************************************
  ************************************************************************/

/****

  OUR permutations: permutation arrays used in FCTs. See Sean's
  thesis for details. The interface function (defined at the
  bottom of this file) is

  const int *get_perm(int n)

  ****/

__device__ __constant__ int OUR4[4] = {0, 3, 2, 1};

__device__ __constant__ int OUR8[8] = {0, 7, 4, 3, 2, 5, 6, 1};

__device__ __constant__ int OUR16[16] =
{0, 15, 8, 7, 4, 11, 12, 3, 2, 13, 10, 5, 6, 9, 14, 1};

__device__ __constant__ int OUR32[32] = 
{0, 31, 16, 15, 8, 23, 24, 7, 4, 27, 20, 11, 12, 19, 28, 3, 2, 29, 18, 13, 
  10, 21, 26, 5, 6, 25, 22, 9, 14, 17, 30, 1};

__device__ __constant__ int OUR64[64] = 
{0, 63, 32, 31, 16, 47, 48, 15, 8, 55, 40, 23, 24, 39, 56, 7, 4, 59, 36, 27, 
  20, 43, 52, 11, 12, 51, 44, 19, 28, 35, 60, 3, 2, 61, 34, 29, 18, 45, 50, 
  13, 10, 53, 42, 21, 26, 37, 58, 5, 6, 57, 38, 25, 22, 41, 54, 9, 14, 49, 
  46, 17, 30, 33, 62, 1};

__device__ __constant__ int OUR128[128] = 
{0, 127, 64, 63, 32, 95, 96, 31, 16, 111, 80, 47, 48, 79, 112, 15, 8, 119, 
  72, 55, 40, 87, 104, 23, 24, 103, 88, 39, 56, 71, 120, 7, 4, 123, 68, 59, 
  36, 91, 100, 27, 20, 107, 84, 43, 52, 75, 116, 11, 12, 115, 76, 51, 44, 83, 
  108, 19, 28, 99, 92, 35, 60, 67, 124, 3, 2, 125, 66, 61, 34, 93, 98, 29, 
  18, 109, 82, 45, 50, 77, 114, 13, 10, 117, 74, 53, 42, 85, 106, 21, 26, 
  101, 90, 37, 58, 69, 122, 5, 6, 121, 70, 57, 38, 89, 102, 25, 22, 105, 86, 
  41, 54, 73, 118, 9, 14, 113, 78, 49, 46, 81, 110, 17, 30, 97, 94, 33, 62, 
  65, 126, 1};

__device__ __constant__ int OUR256[256] = 
{0, 255, 128, 127, 64, 191, 192, 63, 32, 223, 160, 95, 96, 159, 224, 31, 16, 
  239, 144, 111, 80, 175, 208, 47, 48, 207, 176, 79, 112, 143, 240, 15, 8, 
  247, 136, 119, 72, 183, 200, 55, 40, 215, 168, 87, 104, 151, 232, 23, 24, 
  231, 152, 103, 88, 167, 216, 39, 56, 199, 184, 71, 120, 135, 248, 7, 4, 
  251, 132, 123, 68, 187, 196, 59, 36, 219, 164, 91, 100, 155, 228, 27, 20, 
  235, 148, 107, 84, 171, 212, 43, 52, 203, 180, 75, 116, 139, 244, 11, 12, 
  243, 140, 115, 76, 179, 204, 51, 44, 211, 172, 83, 108, 147, 236, 19, 28, 
  227, 156, 99, 92, 163, 220, 35, 60, 195, 188, 67, 124, 131, 252, 3, 2, 253, 
  130, 125, 66, 189, 194, 61, 34, 221, 162, 93, 98, 157, 226, 29, 18, 237, 
  146, 109, 82, 173, 210, 45, 50, 205, 178, 77, 114, 141, 242, 13, 10, 245, 
  138, 117, 74, 181, 202, 53, 42, 213, 170, 85, 106, 149, 234, 21, 26, 229, 
  154, 101, 90, 165, 218, 37, 58, 197, 186, 69, 122, 133, 250, 5, 6, 249, 
  134, 121, 70, 185, 198, 57, 38, 217, 166, 89, 102, 153, 230, 25, 22, 233, 
  150, 105, 86, 169, 214, 41, 54, 201, 182, 73, 118, 137, 246, 9, 14, 241, 
  142, 113, 78, 177, 206, 49, 46, 209, 174, 81, 110, 145, 238, 17, 30, 225, 
  158, 97, 94, 161, 222, 33, 62, 193, 190, 65, 126, 129, 254, 1};

__device__ __constant__ int OUR512[512] = 
{0, 511, 256, 255, 128, 383, 384, 127, 64, 447, 320, 191, 192, 319, 448, 63, 
  32, 479, 288, 223, 160, 351, 416, 95, 96, 415, 352, 159, 224, 287, 480, 31, 
  16, 495, 272, 239, 144, 367, 400, 111, 80, 431, 336, 175, 208, 303, 464, 
  47, 48, 463, 304, 207, 176, 335, 432, 79, 112, 399, 368, 143, 240, 271, 
  496, 15, 8, 503, 264, 247, 136, 375, 392, 119, 72, 439, 328, 183, 200, 311, 
  456, 55, 40, 471, 296, 215, 168, 343, 424, 87, 104, 407, 360, 151, 232, 
  279, 488, 23, 24, 487, 280, 231, 152, 359, 408, 103, 88, 423, 344, 167, 
  216, 295, 472, 39, 56, 455, 312, 199, 184, 327, 440, 71, 120, 391, 376, 
  135, 248, 263, 504, 7, 4, 507, 260, 251, 132, 379, 388, 123, 68, 443, 324, 
  187, 196, 315, 452, 59, 36, 475, 292, 219, 164, 347, 420, 91, 100, 411, 
  356, 155, 228, 283, 484, 27, 20, 491, 276, 235, 148, 363, 404, 107, 84, 
  427, 340, 171, 212, 299, 468, 43, 52, 459, 308, 203, 180, 331, 436, 75, 
  116, 395, 372, 139, 244, 267, 500, 11, 12, 499, 268, 243, 140, 371, 396, 
  115, 76, 435, 332, 179, 204, 307, 460, 51, 44, 467, 300, 211, 172, 339, 
  428, 83, 108, 403, 364, 147, 236, 275, 492, 19, 28, 483, 284, 227, 156, 
  355, 412, 99, 92, 419, 348, 163, 220, 291, 476, 35, 60, 451, 316, 195, 188, 
  323, 444, 67, 124, 387, 380, 131, 252, 259, 508, 3, 2, 509, 258, 253, 130, 
  381, 386, 125, 66, 445, 322, 189, 194, 317, 450, 61, 34, 477, 290, 221, 
  162, 349, 418, 93, 98, 413, 354, 157, 226, 285, 482, 29, 18, 493, 274, 237, 
  146, 365, 402, 109, 82, 429, 338, 173, 210, 301, 466, 45, 50, 461, 306, 
  205, 178, 333, 434, 77, 114, 397, 370, 141, 242, 269, 498, 13, 10, 501, 
  266, 245, 138, 373, 394, 117, 74, 437, 330, 181, 202, 309, 458, 53, 42, 
  469, 298, 213, 170, 341, 426, 85, 106, 405, 362, 149, 234, 277, 490, 21, 
  26, 485, 282, 229, 154, 357, 410, 101, 90, 421, 346, 165, 218, 293, 474, 
  37, 58, 453, 314, 197, 186, 325, 442, 69, 122, 389, 378, 133, 250, 261, 
  506, 5, 6, 505, 262, 249, 134, 377, 390, 121, 70, 441, 326, 185, 198, 313, 
  454, 57, 38, 473, 294, 217, 166, 345, 422, 89, 102, 409, 358, 153, 230, 
  281, 486, 25, 22, 489, 278, 233, 150, 361, 406, 105, 86, 425, 342, 169, 
  214, 297, 470, 41, 54, 457, 310, 201, 182, 329, 438, 73, 118, 393, 374, 
  137, 246, 265, 502, 9, 14, 497, 270, 241, 142, 369, 398, 113, 78, 433, 334, 
  177, 206, 305, 462, 49, 46, 465, 302, 209, 174, 337, 430, 81, 110, 401, 
  366, 145, 238, 273, 494, 17, 30, 481, 286, 225, 158, 353, 414, 97, 94, 417, 
  350, 161, 222, 289, 478, 33, 62, 449, 318, 193, 190, 321, 446, 65, 126, 
  385, 382, 129, 254, 257, 510, 1};


/************************************************************************/
/************************************************************************/

/*** "interface" code to the above arrays ***/

/* returns a pointer to an array containing the OUR permutation
   for the specified problem size n. */

__device__ int *get_perm(int n)
{
  switch(n)
    {
    case 4: return OUR4;
    case 8: return OUR8;
    case 16: return OUR16;
    case 32: return OUR32;
    case 64: return OUR64;
    case 128: return OUR128;
    case 256: return OUR256;
    case 512: return OUR512;
    default: return 0;
    }
}
