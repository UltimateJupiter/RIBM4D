/***************************************************************************
  **************************************************************************
    
  Spherical Harmonic Transform Kit 2.7
    
  Copyright 1997-2003  Sean Moore, Dennis Healy,
                       Dan Rockmore, Peter Kostelec
  Copyright 2004  Peter Kostelec, Dan Rockmore

  This file is part of SpharmonicKit.

  SpharmonicKit is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 3 of the License, or
  (at your option) any later version.

  SpharmonicKit is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  
  See the accompanying LICENSE file for details.

  ************************************************************************
  ************************************************************************/

/* quadrature weights file */

/* contains precomputed arrays of Legendre quadrature weight values */

/***

  The interface function to these arrays is defined at the end
  of this file. It is

  const double *get_weights( int bw )

  ***/


__device__ __constant__ double w4[8] = 
{0.06698294569888951, 0.222987933015572, 0.3241525190659486, 
 0.3858766022239052, 0.3858766022242057, 0.3241525190660357, 
 0.222987933015605, 0.06698294569889861};

__device__ __constant__ double w8[16] = 
{0.0168027552304648, 0.058336464069326, 0.0917183132052142, 
  0.1251296181582697, 0.1513924616369861, 0.1734194117717632, 
  0.1877497281148386, 0.1954512478118618, 0.1954512478124817, 
  0.187749728115036, 0.1734194117718737, 0.1513924616370552, 
  0.1251296181583115, 0.0917183132052395, 0.0583364640693394, 
  0.0168027552304693};

__device__ __constant__ double w16[32] = 
{0.004204256199901001, 0.014748328130096, 0.023629778419644, 
  0.033237125953057, 0.041849747749195, 0.050571719994984, 0.05840156832621, 
  0.065996706406676, 0.07268790949655301, 0.078899622945272, 
  0.084170977199815, 0.088777632866959, 0.092414154989675, 0.095247804861176, 
  0.097103167890767, 0.09805949856685, 0.098059498568105, 0.09710316789118, 
  0.095247804861419, 0.092414154989843, 0.088777632867086, 0.084170977199914, 
  0.07889962294535, 0.07268790949661499, 0.06599670640672201, 
  0.05840156832624701, 0.050571719995013, 0.04184974774921601, 
  0.033237125953072, 0.023629778419653, 0.014748328130102, 0.004204256199904};

__device__ __constant__ double w32[64] = 
{0.001051287070134, 0.00369738253841, 0.005951729000078, 0.00843412760248, 
  0.010722073632584, 0.013119273230032, 0.015375045276171, 0.017685873258142, 
  0.019875170205663, 0.022085297687726, 0.02418169220008, 0.026273624541033, 
  0.028254130235429, 0.03020985118730501, 0.032053730303588, 
  0.033855733201296, 0.035544150136538, 0.037175968389769, 0.038691923240227, 
  0.040138463486499, 0.04146682983648501, 0.042714610025193, 
  0.04384221112648501, 0.044879543239542, 0.045795238152625, 
  0.04661237251476801, 0.047307138466904, 0.04789637733659801, 
  0.048363381016468, 0.048719165059896, 0.048953818726571, 0.049072788071371, 
  0.04907278807389301, 0.048953818727408, 0.04871916506039601, 
  0.048363381016822, 0.04789637733687, 0.047307138467123, 0.046612372514951, 
  0.04579523815278, 0.044879543239676, 0.043842211126604, 
  0.04271461002529901, 0.04146682983657701, 0.04013846348658201, 
  0.0386919232403, 0.037175968389834, 0.035544150136597, 0.033855733201345, 
  0.032053730303631, 0.030209851187344, 0.028254130235463, 0.026273624541062, 
  0.024181692200106, 0.022085297687748, 0.019875170205683, 0.017685873258158, 
  0.015375045276184, 0.013119273230042, 0.010722073632593, 0.008434127602487, 
  0.005951729000084, 0.003697382538416, 0.001051287070135};

__device__ __constant__ double w64[128] = 
{0.000262835707197, 0.000924989999111, 0.001490708223128, 0.002116377084453, 
  0.002696897333212, 0.003309996179437, 0.003893120261077, 0.004497543115599, 
  0.005078810319213, 0.005675008203167, 0.00625174592528, 0.006839175137552, 
  0.007409342588573999, 0.007987078618147001, 0.008548922859887, 
  0.009115873663663, 0.009667799842016, 0.010222796978386, 0.010763311740366, 
  0.011305155615914, 0.01183284018059, 0.012360325369511, 0.012873822157835, 
  0.013385753079517, 0.013883759122364, 0.014378960637318, 0.01486022460612, 
  0.015337549735279, 0.015800871005997, 0.016259206915535, 0.016703435812042, 
  0.017141708689126, 0.017565747421518, 0.017982926599289, 0.018385730608967, 
  0.018780832153766, 0.019161411686675, 0.019533501577973, 0.019890923371016, 
  0.020239120355893, 0.020572509359939, 0.020895987534359, 0.021204528621207, 
  0.021502519771847, 0.021785459387897, 0.022057255116519, 0.022313902856023, 
  0.022558856500676, 0.022788586578443, 0.023006114940762, 0.023208367548925, 
  0.023397952433377, 0.023572234970434, 0.023733424539198, 0.023879312701991, 
  0.02401172264761, 0.024128861378958, 0.024232175915971, 0.02432028020224, 
  0.024394252878361, 0.02445310839246, 0.024497562719501, 0.024527026305793, 
  0.0245418562091, 0.024541856214155, 0.024527026307477, 0.02449756272051, 
  0.024453108393178, 0.024394252878919, 0.024320280202694, 0.024232175916354, 
  0.024128861379288, 0.0240117226479, 0.023879312702248, 0.023733424539429, 
  0.023572234970644, 0.023397952433567, 0.0232083675491, 0.023006114940923, 
  0.022788586578593, 0.022558856500815, 0.022313902856155, 0.022057255116642, 
  0.021785459388013, 0.021502519771957, 0.021204528621309, 0.020895987534455, 
  0.020572509360028, 0.020239120355979, 0.019890923371095, 0.019533501578048, 
  0.019161411686746, 0.018780832153833, 0.018385730609031, 0.01798292659935, 
  0.017565747421574, 0.017141708689177, 0.01670343581209, 0.016259206915579, 
  0.015800871006039, 0.015337549735318, 0.014860224606157, 0.014378960637354, 
  0.013883759122397, 0.013385753079548, 0.012873822157864, 0.012360325369538, 
  0.011832840180615, 0.011305155615937, 0.010763311740387, 0.010222796978406, 
  0.009667799842034, 0.00911587366368, 0.008548922859902, 
  0.007987078618162001, 0.007409342588588, 0.006839175137563, 
  0.00625174592529, 0.005675008203175001, 0.005078810319221, 
  0.004497543115606001, 0.003893120261083, 0.003309996179442, 
  0.002696897333215, 0.002116377084455, 0.00149070822313, 0.000924989999113, 
  0.000262835707198};

/************************************************************************/
/* returns a pointer to the proper quadrature weights for a given
   bandwidth bw.  Weights array is of size 2*bw. A closed form for
   the weights can be found in the original Driscoll and Healy paper,
   but need to be normalized */

__device__ double *get_weights(int bw)
{

  switch(bw)
    {
    case 4: return w4;
    case 8: return w8;
    case 16: return w16;
    case 32: return w32;
    case 64: return w64;
    default: return 0;
  }
}

